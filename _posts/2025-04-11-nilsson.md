---
layout: default
title:  "Readme doc of Program of computing Nilsson levels"
date:   2025-04-11 
categories: physics research-note
---

This doc is the readme file of the directory NilBCS.

Last edited : 2025 Apr

程序是建立在之前写的nil_2023程序的基础上的

此程序分为两部分，第一部分是文件夹nil，是用Fortran编写的程序，负责计算Nilsson levels，输入文件是inputdata.f90，输出文件是Nil_energy打头的几个文件。第二部分是用matlab编写的程序，负责解BCS equation然后得到费米面、pairing gap以及BCS准粒子能级。


## Part 1： nil文件夹

此程序暂时仅适用于轴对称的Nilsson Hamiltonian

#### Inputs：

$A$: 核子数

$\varepsilon_2$: 形变参数

$\kappa$: 自旋轨道耦合参数

$\mu$: 修正参数

$N_n, N_p$: 中子和质子的shells

#### 计算方法：

Axial-symmetric Nilsson hamiltonian：
\[
\begin{aligned}
h
&=-\frac{\hbar^{2}}{2 m} \Delta+\frac{m}{2} \omega^{2} r^{2}\left(1-2\beta Y_{20}\right)-\kappa \hbar \omega_{0}\left(2 \vec{l} \cdot \vec{s}+\mu \vec{l}^{2}\right) \\ & = h_0-\beta m \omega^{2} b^{2} (r')^2Y_{20}-\kappa \hbar \omega_{0}\left(2 \vec{l} \cdot \vec{s}+\mu \vec{l}^{2}\right) \\
& = h_0-\beta \hbar\omega (r')^2Y_{20}-\kappa \hbar \omega_{0}\left(2 \vec{l} \cdot \vec{s}+\mu \vec{l}^{2}\right)\\
& = h_0-\beta \hbar\omega (r')^2Y_{20}-\kappa \hbar \omega_{0}\left( \vec{j}^2 + (\mu-1) \vec{l}^{2} - \vec{s}^2 \right)
\end{aligned}
\]

这里的$\omega$在传统的做法中，需要根据等体积原则，和$\omega_0$做一个转换：
\[
\omega=\omega_0(1-\dfrac{4}{3}\varepsilon_2^2-\dfrac{16}{27}\varepsilon_2^3)^{-1/6}
\]

形变参数$\beta$和$\varepsilon_2$的关系为：
\[
\beta=\dfrac{4}{3}\sqrt{\dfrac{\pi}{5}}\varepsilon_2=1.05688728\times\varepsilon_2
\]

程序的核心是diag.f90文件，这个文件包含了函数nil_energy，执行后即返回Nilsson levels的能量。

由于后面第二部分的计算，只需要Nilsson Hamiltonian的能级信息，也就是只要本征能量，不需要本征态。因此我们在计算时可以不考虑任何对称性，直接对角化出本征能量以及本征态即可。

#### Outputs：

Nil_energy_n_1, Nil_energy_n_2, Nil_energy_n_3: 中子的Nilsson energy，1、2、3是由低到高三个价壳层

质子的输出文件也是这个逻辑

#### Remark：

这部分的代码不多，依赖关系容易看懂

如稍作修改，即可绘制Nilsson diagram，即不同形变下的Nilsson energy

本程序的makefile中使用的是ifx的编译器，运行此程序，需有Linux环境和intel Fortran compiler。只需在命令行执行： make && ./nil && make clean  即可